namespace: us
description: United States PII patterns

patterns:
  - id: ssn_01
    location: us
    category: ssn
    description: US Social Security Number (XXX-XX-XXXX)
    pattern: '\b(?!000|666|9[0-9]{2})[0-9]{3}-?(?!00)[0-9]{2}-?(?!0000)[0-9]{4}\b'
    mask: "***-**-****"
    examples:
      match:
        - "123-45-6789"
        - "123456789"
        - "555-12-3456"
      nomatch:
        - "000-12-3456"
        - "666-12-3456"
        - "900-12-3456"
        - "123-00-4567"
        - "123-45-0000"
        - "12-345-6789"
        - "1234-56-789"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Validates against basic SSA rules: no 000, 666, 900-999 in first group; no 00 in middle; no 0000 in last group"

  - id: phone_01
    location: us
    category: phone
    description: US phone number (10 digits with optional country code)
    pattern: '(?:\+1[-. ]?)?(?:\([2-9][0-9]{2}\)|[2-9][0-9]{2})[-. ]?[1-9][0-9]{2}[-. ]?[0-9]{4}'
    mask: "(***) ***-****"
    examples:
      match:
        - "(555) 123-4567"
        - "555-123-4567"
        - "+1-555-123-4567"
        - "+1 (555) 123-4567"
        - "(212) 555-1234"
      nomatch:
        - "(111) 123-4567"
        - "(555) 012-3456"
        - "123-4567"
        - "555-12-34567"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high

  - id: zipcode_01
    location: us
    category: address
    description: US ZIP code (5 digits or ZIP+4)
    pattern: '\b[0-9]{5}(?:-[0-9]{4})?\b'
    mask: "*****"
    examples:
      match:
        - "12345"
        - "12345-6789"
      nomatch:
        - "1234"
        - "123456"
    policy:
      store_raw: false
      action_on_match: report
      severity: low

  - id: passport_01
    location: us
    category: passport
    description: US passport number (9 digits or letter followed by 8 digits)
    pattern: '\b(?:[0-9]{9}|[A-Z][0-9]{8})\b'
    flags: [IGNORECASE]
    mask: "*********"
    examples:
      match:
        - "123456789"
        - "A12345678"
      nomatch:
        - "12345678"
        - "AB1234567"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: ein_01
    location: us
    category: other
    description: Employer Identification Number (XX-XXXXXXX)
    pattern: '\b[0-9]{2}-?[0-9]{7}\b'
    mask: "**-*******"
    examples:
      match:
        - "12-3456789"
        - "123456789"
      nomatch:
        - "123-456789"
        - "12-345678"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium

  - id: itin_01
    location: us
    category: ssn
    description: Individual Taxpayer Identification Number (9XX-XX-XXXX)
    pattern: '\b9[0-9]{2}-?[0-9]{2}-?[0-9]{4}\b'
    mask: "***-**-****"
    examples:
      match:
        - "900-12-3456"
        - "999123456"
      nomatch:
        - "800-12-3456"
        - "123-45-6789"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: driver_license_ca_01
    location: us
    category: other
    description: California driver's license (1 letter + 7 digits)
    pattern: '\b[A-Z][0-9]{7}\b'
    flags: [IGNORECASE]
    mask: "A*******"
    examples:
      match:
        - "A1234567"
        - "z9876543"
      nomatch:
        - "AB123456"
        - "1234567"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      state: "CA"

  - id: medicare_01
    location: us
    category: other
    description: Medicare Beneficiary Identifier (1 letter + 10 alphanumeric)
    pattern: '\b[A-Z][0-9]{3}[A-Z]{2}[0-9]{4}[A-Z]\b'
    flags: [IGNORECASE]
    mask: "A***AA****A"
    examples:
      match:
        - "A123BC4567D"
      nomatch:
        - "123456789"
        - "A1234567890"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical