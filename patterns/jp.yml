namespace: jp
description: Japan PII patterns

patterns:
  - id: mobile_01
    location: jp
    category: phone
    description: Japanese mobile phone number (090/080/070-XXXX-XXXX)
    pattern: '0[789]0-?[0-9]{4}-?[0-9]{4}'
    mask: "0**-****-****"
    examples:
      match:
        - "090-1234-5678"
        - "08012345678"
        - "070-9876-5432"
      nomatch:
        - "060-1234-5678"
        - "090-123-45678"
        - "0901-234-5678"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high

  - id: landline_01
    location: jp
    category: phone
    description: Japanese landline number (area code + number)
    pattern: '0(?!([789]0))[1-9][0-9]?-?[0-9]{3,4}-?[0-9]{4}'
    mask: "0*-****-****"
    examples:
      match:
        - "03-1234-5678"
        - "06-6789-0123"
        - "011-123-4567"
        - "0312345678"
      nomatch:
        - "00-1234-5678"
        - "090-1234-5678"
        - "03-12345-678"
    policy:
      store_raw: false
      action_on_match: report
      severity: low

  - id: my_number_01
    location: jp
    category: other
    description: Japanese My Number (12 digits)
    pattern: '[0-9]{4}-?[0-9]{4}-?[0-9]{4}'
    mask: "****-****-****"
    examples:
      match:
        - "1234-5678-9012"
        - "123456789012"
        - "9876-5432-1098"
      nomatch:
        - "123-456-789012"
        - "12345-6789-012"
        - "1234567890"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Japan's individual number system introduced in 2015"

  - id: passport_01
    location: jp
    category: passport
    description: Japanese passport number (2 letters + 7 digits)
    pattern: '[A-Z]{2}[0-9]{7}'
    flags: [IGNORECASE]
    mask: "AA*******"
    examples:
      match:
        - "AB1234567"
        - "XY9876543"
        - "cd2345678"
      nomatch:
        - "A1234567"
        - "ABC123456"
        - "AB12345678"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: zipcode_01
    location: jp
    category: address
    description: Japanese postal code (XXX-XXXX)
    pattern: '[0-9]{3}-?[0-9]{4}'
    mask: "***-****"
    examples:
      match:
        - "123-4567"
        - "1234567"
        - "100-0001"
      nomatch:
        - "12-34567"
        - "1234-567"
        - "12345678"
    policy:
      store_raw: false
      action_on_match: report
      severity: low

  - id: address_01
    location: jp
    category: address
    description: Japanese full address with postal code, prefecture, city, and detailed components
    pattern: '^(?:(?:〒?\s*)?(?<zip>[0-9０-９]{3}[-−‐][0-9０-９]{4})\s*)?(?<pref>北海道|東京都|大阪府|京都府|青森県|岩手県|宮城県|秋田県|山形県|福島県|茨城県|栃木県|群馬県|埼玉県|千葉県|神奈川県|新潟県|富山県|石川県|福井県|山梨県|長野県|岐阜県|静岡県|愛知県|三重県|滋賀県|兵庫県|奈良県|和歌山県|鳥取県|島根県|岡山県|広島県|山口県|徳島県|香川県|愛媛県|高知県|福岡県|佐賀県|長崎県|熊本県|大分県|宮崎県|鹿児島県|沖縄県)\s*(?:(?<gun>[\p{Script=Han}\p{Hiragana}\p{Katakana}ー々]+郡)\s*)?(?<city>[\p{Script=Han}\p{Hiragana}\p{Katakana}ー々]+(?:市|区|町|村))\s*(?:(?<area>[\p{Script=Han}\p{Hiragana}\p{Katakana}ー々]+(?:町|大字|字))\s*)?(?:(?:(?<chome>[0-9０-９]+)丁目\s*)?(?:(?<ban>[0-9０-９]+)番\s*)?(?:(?<go>[0-9０-９]+)号)?|(?<block>[0-9０-９]+(?:[-−‐][0-9０-９]+){1,2}))(?:\s*(?<bldg>[^()\s]+))?(?:\s*(?<floor>[0-9０-９]+(?:F|階)))?(?:\s*(?<room>[0-9０-９]+号室))?(?:\s*\((?<note>[^)]+)\))?(?:\s*(?<detail>.*))?$'
    mask: "***-**** *** *** ***"
    examples:
      match:
        - "〒100-0001 東京都千代田区千代田1-1-1"
        - "大阪府大阪市中央区本町2丁目3番4号"
        - "神奈川県横浜市西区みなとみらい3-4-1 ランドマークタワー10F"
        - "京都府京都市左京区吉田本町36-1 京都大学"
        - "北海道札幌市中央区北1条西2-1-1"
      nomatch:
        - "アメリカ合衆国ニューヨーク州"
        - "123 Main Street"
        - "東京都"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      note: "Comprehensive Japanese address pattern with named capture groups for postal code, prefecture, city, and address components"

  - id: address_02
    location: jp
    category: address
    description: Japanese address with simplified tail component (postal code, prefecture, city, and remaining address)
    pattern: '^(?:(?:〒?\s*)?(?<zip>[0-9０-９]{3}(?:[-−‐][0-9０-９]{4})?)\s*)?(?<pref>北海道|東京都|大阪府|京都府|青森県|岩手県|宮城県|秋田県|山形県|福島県|茨城県|栃木県|群馬県|埼玉県|千葉県|神奈川県|新潟県|富山県|石川県|福井県|山梨県|長野県|岐阜県|静岡県|愛知県|三重県|滋賀県|兵庫県|奈良県|和歌山県|鳥取県|島根県|岡山県|広島県|山口県|徳島県|香川県|愛媛県|高知県|福岡県|佐賀県|長崎県|熊本県|大分県|宮崎県|鹿児島県|沖縄県)\s*(?:(?<gun>[\p{Script=Han}\p{Hiragana}\p{Katakana}ー々]+郡)\s*)?(?<city>[\p{Script=Han}\p{Hiragana}\p{Katakana}ー々]+(?:市|区|町|村))\s*(?<tail>.+)$'
    mask: "***-**** *** *** ***"
    examples:
      match:
        - "〒100-0001 東京都千代田区千代田1-1-1"
        - "大阪府大阪市中央区本町2丁目3番4号"
        - "神奈川県横浜市西区みなとみらい3-4-1 ランドマークタワー10F"
        - "京都府京都市左京区吉田本町36-1"
        - "100 北海道札幌市中央区北1条西2-1-1"
      nomatch:
        - "東京都千代田区"
        - "〒100-0001"
        - "アメリカ合衆国"
        - "123 Main Street"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      note: "Simplified Japanese address pattern that captures the tail portion as a single group, useful for less detailed parsing"

  - id: driver_license_01
    location: jp
    category: other
    description: Japanese driver's license (12 digits)
    pattern: '[0-9]{4}-?[0-9]{2}-?[0-9]{6}'
    mask: "****-**-******"
    examples:
      match:
        - "1234-56-789012"
        - "123456789012"
        - "9876-54-321098"
      nomatch:
        - "123-456-789012"
        - "12345-6-789012"
        - "1234567890"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high

  - id: bank_account_01
    location: jp
    category: bank
    description: Japanese bank account number (7 digits)
    pattern: '[0-9]{7}'
    mask: "*******"
    examples:
      match:
        - "1234567"
        - "9876543"
      nomatch:
        - "123456"
        - "12345678"
        - "A123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Standard format for most Japanese banks"

  # Mizuho Bank (みずほ銀行) - Bank Code: 0001
  - id: mizuho_bank_account_01
    location: jp
    category: bank
    description: Mizuho Bank account (0001-XXX-XXXXXXX)
    pattern: '0001-?[0-9]{3}-?[0-9]{7}'
    mask: "0001-***-*******"
    examples:
      match:
        - "0001-123-1234567"
        - "0001123987654321"
        - "0001-456-7890123"
      nomatch:
        - "0002-123-1234567"
        - "0001-12-1234567"
        - "0001-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Mizuho Bank (みずほ銀行) - One of Japan's three megabanks"

  # Sumitomo Mitsui Banking Corporation (三井住友銀行) - Bank Code: 0009
  - id: smbc_bank_account_01
    location: jp
    category: bank
    description: SMBC account (0009-XXX-XXXXXXX)
    pattern: '0009-?[0-9]{3}-?[0-9]{7}'
    mask: "0009-***-*******"
    examples:
      match:
        - "0009-123-1234567"
        - "0009123987654321"
        - "0009-789-0123456"
      nomatch:
        - "0008-123-1234567"
        - "0009-12-1234567"
        - "0009-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Sumitomo Mitsui Banking Corporation (三井住友銀行) - Major Japanese megabank"

  # MUFG Bank (三菱UFJ銀行) - Bank Code: 0005
  - id: mufg_bank_account_01
    location: jp
    category: bank
    description: MUFG Bank account (0005-XXX-XXXXXXX)
    pattern: '0005-?[0-9]{3}-?[0-9]{7}'
    mask: "0005-***-*******"
    examples:
      match:
        - "0005-123-1234567"
        - "0005123987654321"
        - "0005-456-7890123"
      nomatch:
        - "0004-123-1234567"
        - "0005-12-1234567"
        - "0005-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "MUFG Bank (三菱UFJ銀行) - Mitsubishi UFJ Financial Group"

  # Resona Bank (りそな銀行) - Bank Code: 0010
  - id: resona_bank_account_01
    location: jp
    category: bank
    description: Resona Bank account (0010-XXX-XXXXXXX)
    pattern: '0010-?[0-9]{3}-?[0-9]{7}'
    mask: "0010-***-*******"
    examples:
      match:
        - "0010-123-1234567"
        - "0010123987654321"
        - "0010-789-0123456"
      nomatch:
        - "0011-123-1234567"
        - "0010-12-1234567"
        - "0010-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Resona Bank (りそな銀行) - Major regional bank"

  # Japan Post Bank (ゆうちょ銀行) - Special format
  - id: japan_post_bank_account_01
    location: jp
    category: bank
    description: Japan Post Bank account (XXXXX-X to XXXXXXXX)
    pattern: '[0-9]{5}-?[0-9]{1,8}'
    mask: "*****-********"
    examples:
      match:
        - "12345-1"
        - "98765-12345678"
        - "123451234567"
        - "00123-456"
      nomatch:
        - "1234-123456"
        - "123456-123456789"
        - "12345-"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Japan Post Bank (ゆうちょ銀行) - 5-digit store number + 1-8 digit account number"

  # Seven Bank (セブン銀行) - Bank Code: 0034
  - id: seven_bank_account_01
    location: jp
    category: bank
    description: Seven Bank account (0034-XXX-XXXXXXX)
    pattern: '0034-?[0-9]{3}-?[0-9]{7}'
    mask: "0034-***-*******"
    examples:
      match:
        - "0034-123-1234567"
        - "0034123987654321"
        - "0034-001-7890123"
      nomatch:
        - "0035-123-1234567"
        - "0034-12-1234567"
        - "0034-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Seven Bank (セブン銀行) - Convenience store banking"

  # Rakuten Bank (楽天銀行) - Bank Code: 0036
  - id: rakuten_bank_account_01
    location: jp
    category: bank
    description: Rakuten Bank account (0036-XXX-XXXXXXX)
    pattern: '0036-?[0-9]{3}-?[0-9]{7}'
    mask: "0036-***-*******"
    examples:
      match:
        - "0036-123-1234567"
        - "0036123987654321"
        - "0036-001-7890123"
      nomatch:
        - "0037-123-1234567"
        - "0036-12-1234567"
        - "0036-123-123456"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Rakuten Bank (楽天銀行) - Online banking service"

  # Generic Japanese bank account (for other banks)
  - id: generic_japanese_bank_account_01
    location: jp
    category: bank
    description: Generic Japanese bank account (XXXX-XXX-XXXXXXX)
    pattern: '[0-9]{4}-?[0-9]{3}-?[0-9]{7}'
    mask: "****-***-*******"
    examples:
      match:
        - "1234-567-8901234"
        - "0123456789012345"
        - "9999-001-1111111"
      nomatch:
        - "123-567-8901234"
        - "1234-56-8901234"
        - "1234-567-890123"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: "Generic format for Japanese banks: 4-digit bank code + 3-digit branch code + 7-digit account number"

  - id: japanese_name_hiragana_01
    location: jp
    category: name
    description: Japanese name in Hiragana (2-8 characters)
    pattern: '\b[\u3040-\u309f]{2,8}\b'
    mask: "***"
    examples:
      match:
        - "たなか"
        - "やまだたろう"
        - "さとうはなこ"
        - "すずき"
      nomatch:
        - "た"
        - "abcd"
        - "田中"
        - "123"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      note: "Matches Hiragana characters only"

  - id: japanese_name_katakana_01
    location: jp
    category: name
    description: Japanese name in Katakana (2-8 characters)
    pattern: '\b[\u30a0-\u30ff]{2,8}\b'
    mask: "***"
    examples:
      match:
        - "タナカ"
        - "ヤマダタロウ"
        - "サトウハナコ"
        - "スズキ"
      nomatch:
        - "タ"
        - "abcd"
        - "田中"
        - "123"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      note: "Matches Katakana characters only"

  - id: japanese_name_kanji_01
    location: jp
    category: name
    description: Japanese name in Kanji (2-4 characters)
    pattern: '\b[\u4e00-\u9fff]{2,4}\b'
    mask: "***"
    examples:
      match:
        - "田中"
        - "山田太郎"
        - "佐藤花子"
        - "鈴木"
      nomatch:
        - "田"
        - "abcd"
        - "たなか"
        - "123"
    policy:
      store_raw: false
      action_on_match: redact
      severity: high
    metadata:
      note: "Matches Kanji characters. Most common format for Japanese names."
